<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>期末 Power BI 報告規範 | 智慧分析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Animation delays */
        .animation-delay-2000 { animation-delay: 2s; }
        .animation-delay-4000 { animation-delay: 4s; }
        
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob {
            animation: blob 7s infinite;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased selection:bg-blue-100 selection:text-blue-900">

    <!-- Navigation -->
    <nav class="fixed w-full z-50 transition-all duration-300 bg-white/90 backdrop-blur-md border-b border-slate-200 shadow-sm" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex-shrink-0 flex items-center gap-2 cursor-pointer" onclick="scrollToSection('hero')">
                    <!-- Icon: Bar Chart -->
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                    <span class="font-bold text-xl tracking-tight text-slate-900">Final Project<span class="text-blue-600">.BI</span></span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="#requirements" class="text-slate-500 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">報告規範</a>
                    <a href="#rubric" class="text-slate-500 hover:text-emerald-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">評分標準</a>
                    <a href="#resources" class="text-slate-500 hover:text-purple-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">繳交說明</a>
                </div>
                <div class="md:hidden">
                    <!-- Mobile menu button placeholder -->
                    <button class="text-slate-500 hover:text-slate-900 focus:outline-none" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                    </button>
                </div>
            </div>
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden pb-4">
                <a href="#requirements" class="block text-slate-500 hover:text-blue-600 px-3 py-2 rounded-md text-base font-medium">報告規範</a>
                <a href="#rubric" class="block text-slate-500 hover:text-emerald-600 px-3 py-2 rounded-md text-base font-medium">評分標準</a>
                <a href="#resources" class="block text-slate-500 hover:text-purple-600 px-3 py-2 rounded-md text-base font-medium">繳交說明</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="hero" class="relative pt-32 pb-20 lg:pt-48 lg:pb-32 overflow-hidden bg-slate-900">
        <div class="absolute inset-0">
            <svg class="absolute right-0 top-0 h-full w-1/2 text-slate-800 transform translate-x-1/3 opacity-20" fill="currentColor" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true">
                <polygon points="50,0 100,0 50,100 0,100" />
            </svg>
            <!-- Decorative gradient blobs -->
            <div class="absolute top-20 left-20 w-72 h-72 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"></div>
            <div class="absolute top-20 right-20 w-72 h-72 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"></div>
            <div class="absolute -bottom-32 left-1/2 w-72 h-72 bg-emerald-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"></div>
        </div>
        
        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="inline-flex items-center px-4 py-1.5 rounded-full border border-blue-500/30 bg-blue-500/10 text-blue-300 text-sm font-semibold mb-6">
                <span class="flex h-2 w-2 rounded-full bg-blue-400 mr-2"></span>
                2025 Fall Semester
            </div>
            <h1 class="text-4xl tracking-tight font-extrabold text-white sm:text-5xl md:text-7xl mb-6">
                中原大學 <br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-teal-400 to-emerald-400">POWER BI期末報告規範與指引</span>
            </h1>
            <p class="mt-4 max-w-2xl mx-auto text-xl text-slate-300">
                將原始數據轉化為決策方針。這是一份關於邏輯、美學與互動設計的綜合挑戰。
            </p>
            <div class="mt-10 flex justify-center gap-4 flex-wrap">
                <a href="#requirements" class="px-8 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 md:py-4 md:text-lg transition-all shadow-lg shadow-blue-500/30">
                    開始閱讀規範
                </a>
                <a href="#rubric" class="px-8 py-3 border border-slate-600 text-base font-medium rounded-lg text-slate-200 hover:bg-slate-800 md:py-4 md:text-lg transition-all backdrop-blur-sm">
                    查看評分佔比
                </a>
            </div>
        </div>
    </section>

    <!-- Main Content: Requirements Grid -->
    <section id="requirements" class="py-20 bg-slate-50 relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl font-extrabold text-slate-900 sm:text-4xl">
                    五大視覺化模組要求
                </h2>
                <p class="mt-4 text-lg text-slate-600">
                    您的 Power BI 報告必須包含以下分析視角。點擊卡片查看詳細實作規格。
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="module-grid">
                <!-- Cards will be injected by JS -->
            </div>

            <!-- Details Panel (Modal) -->
            <div id="detail-panel" class="hidden fixed inset-0 z-[60] overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
                <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                    <div class="fixed inset-0 bg-slate-900 bg-opacity-75 transition-opacity backdrop-blur-sm" aria-hidden="true" onclick="closeModal()"></div>
                    <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
                    
                    <div class="inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full">
                        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                            <div class="sm:flex sm:items-start">
                                <div id="modal-icon-bg" class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full sm:mx-0 sm:h-10 sm:w-10 bg-blue-100">
                                    <!-- Icon injected here -->
                                    <svg id="modal-icon" class="h-6 w-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"></svg>
                                </div>
                                <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                                    <h3 class="text-2xl leading-6 font-bold text-slate-900" id="modal-title">
                                        Module Title
                                    </h3>
                                    <div class="mt-4">
                                        <p class="text-sm text-slate-500 mb-4 bg-slate-100 p-2 rounded inline-block font-mono" id="modal-ref">
                                            Reference: Page 1
                                        </p>
                                        <div class="mt-2 space-y-4">
                                            <div>
                                                <h4 class="font-bold text-slate-800 mb-2 border-b border-slate-100 pb-2">實作細節</h4>
                                                <ul class="list-none space-y-2" id="modal-details">
                                                    <!-- List items injected here -->
                                                </ul>
                                            </div>
                                            <div class="bg-blue-50 p-4 rounded-lg border border-blue-100 mt-4">
                                                <h4 class="font-bold text-blue-900 mb-2 text-sm flex items-center">
                                                    <svg class="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                                    設計提示
                                                </h4>
                                                <p class="text-sm text-blue-800" id="modal-desc">Description here.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse border-t border-slate-100">
                            <button type="button" class="w-full inline-flex justify-center rounded-lg border border-transparent shadow-sm px-4 py-2 bg-slate-900 text-base font-medium text-white hover:bg-slate-800 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm transition-colors" onclick="closeModal()">
                                了解，關閉視窗
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Rubric Section -->
    <section id="rubric" class="py-20 bg-white border-t border-slate-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="lg:grid lg:grid-cols-2 lg:gap-16 items-center">
                <div>
                    <h2 class="text-3xl font-extrabold text-slate-900 mb-6">
                        評分標準
                        <span class="block text-emerald-600 text-lg font-medium mt-1">Rubric & Criteria</span>
                    </h2>
                    <p class="text-lg text-slate-600 mb-8">
                        我們看重的不僅是圖表的美觀，更看重數據背後的邏輯與故事。總分 100%，請務必關注以下三個維度。
                    </p>
                    
                    <div class="space-y-6">
                        <!-- Logic -->
                        <div class="bg-slate-50 p-6 rounded-xl border border-slate-100 relative overflow-hidden group hover:border-blue-200 transition-colors">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="text-lg font-bold text-slate-800">邏輯正確性 & 資料洞察</h3>
                                <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-bold">40%</span>
                            </div>
                            <div class="w-full bg-slate-200 rounded-full h-2.5 mb-2">
                                <div class="bg-blue-600 h-2.5 rounded-full" style="width: 40%"></div>
                            </div>
                            <p class="text-sm text-slate-500">DAX 公式計算無誤 (MoM, YoY, 成功率)、圖表選用是否適合該類數據、能否正確回答業務問題。</p>
                        </div>

                        <!-- Aesthetics -->
                        <div class="bg-slate-50 p-6 rounded-xl border border-slate-100 relative overflow-hidden group hover:border-emerald-200 transition-colors">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="text-lg font-bold text-slate-800">視覺美感 & 版面設計</h3>
                                <span class="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm font-bold">30%</span>
                            </div>
                            <div class="w-full bg-slate-200 rounded-full h-2.5 mb-2">
                                <div class="bg-emerald-500 h-2.5 rounded-full" style="width: 30%"></div>
                            </div>
                            <p class="text-sm text-slate-500">配色協調 (不刺眼、具備主題性)、字體統一、版面乾淨整潔、資訊層級清晰。</p>
                        </div>

                        <!-- Interaction -->
                        <div class="bg-slate-50 p-6 rounded-xl border border-slate-100 relative overflow-hidden group hover:border-purple-200 transition-colors">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="text-lg font-bold text-slate-800">互動性 & 創新</h3>
                                <span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-bold">30%</span>
                            </div>
                            <div class="w-full bg-slate-200 rounded-full h-2.5 mb-2">
                                <div class="bg-purple-600 h-2.5 rounded-full" style="width: 30%"></div>
                            </div>
                            <p class="text-sm text-slate-500">篩選器運作正常、圖表間的互動篩選、使用了進階功能 (如：動態軸、書籤 Bookmarks、工具提示頁面)。</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-12 lg:mt-0 relative">
                    <!-- Decorative Graphic -->
                    <div class="absolute inset-0 flex items-center justify-center opacity-10">
                        <svg class="w-96 h-96 text-emerald-300" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"></path>
                            <path d="M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z"></path>
                        </svg>
                    </div>
                    <div class="relative bg-white p-8 rounded-2xl shadow-xl border border-slate-100">
                        <h4 class="text-xl font-bold text-slate-900 mb-6 flex items-center">
                            <svg class="w-6 h-6 text-orange-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                            重要扣分項目 (Checklist)
                        </h4>
                        <ul class="space-y-4">
                            <li class="flex items-start">
                                <div class="flex-shrink-0">
                                    <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                </div>
                                <span class="ml-3 text-slate-600 text-sm"><strong>資料未重新整理：</strong>繳交的檔案開啟後顯示資料錯誤或路徑失效。</span>
                            </li>
                            <li class="flex items-start">
                                <div class="flex-shrink-0">
                                    <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                </div>
                                <span class="ml-3 text-slate-600 text-sm"><strong>圖表破版：</strong>在預設解析度下，圖表互相重疊或文字被切斷。</span>
                            </li>
                            <li class="flex items-start">
                                <div class="flex-shrink-0">
                                    <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                </div>
                                <span class="ml-3 text-slate-600 text-sm"><strong>使用預設標題：</strong>未將圖表標題修改為具商業意義的中文名稱 (例如保留 "Sum of Sales by Month")。</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Submission Section -->
    <section id="resources" class="py-20 bg-slate-900 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-3xl font-extrabold mb-8">準備好繳交了嗎？</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto">
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-blue-500 transition-colors group">
                    <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mx-auto mb-4 text-white font-bold text-xl group-hover:scale-110 transition-transform">1</div>
                    <h3 class="text-xl font-bold mb-2">檢查數據</h3>
                    <p class="text-slate-400 text-sm">確認所有 DAX 量值運算結果正確，且沒有空白圖表。</p>
                </div>
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-emerald-500 transition-colors group">
                    <div class="w-12 h-12 bg-emerald-500 rounded-lg flex items-center justify-center mx-auto mb-4 text-white font-bold text-xl group-hover:scale-110 transition-transform">2</div>
                    <h3 class="text-xl font-bold mb-2">檔案命名</h3>
                    <p class="text-slate-400 text-sm">格式：<code>學號_姓名_期末報告.pbix</code><br>範例：B1103301_王小明_期末報告.pbix</p>
                </div>
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-purple-500 transition-colors group">
                    <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center mx-auto mb-4 text-white font-bold text-xl group-hover:scale-110 transition-transform">3</div>
                    <h3 class="text-xl font-bold mb-2">上傳平台</h3>
                    <p class="text-slate-400 text-sm">請於截止日期前上傳至 i-Learning 作業區。</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-slate-950 text-slate-400 py-12 border-t border-slate-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center text-center md:text-left">
            <div class="mb-4 md:mb-0">
                <p>&copy; 2025 Power BI Visualization Course.</p>
                <p class="text-sm mt-1">Designed for Logical Thinking & Innovation.</p>
            </div>
            <div class="flex space-x-6 justify-center">
                <a href="#" class="hover:text-white transition-colors">課程大綱</a>
                <a href="#" class="hover:text-white transition-colors">聯絡助教</a>
            </div>
        </div>
    </footer>

    <!-- JavaScript for Interactivity -->
    <script>
        // Data for Modules
        const modules = [
            {
                id: 1,
                title: "趨勢與總體分析",
                iconPath: "M13 7h8m0 0v8m0-8l-8 8-4-4-6 6",
                pageRef: "Page 1",
                description: "利用折線圖觀察長期趨勢，重點在於區分「各單位」與「總體」的表現差異。",
                details: [
                    "視覺化類型：折線圖 (Line Chart) 與 區域圖 (Area Chart)",
                    "資料範圍：2024年1月 至 2025年10月",
                    "必要欄位：X軸為年月，Y軸為成功率",
                    "關鍵要求：需包含「各單位成功率比較」與「總成功率」兩張圖表",
                    "進階挑戰：加入預測線或趨勢線，標示異常數值點"
                ],
                color: "blue"
            },
            {
                id: 2,
                title: "關鍵指標 (KPIs)",
                iconPath: "M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",
                pageRef: "Page 2",
                description: "老闆最在意的核心數字。需能夠一眼看出與上個月或去年的差異。",
                details: [
                    "視覺化類型：多列卡片 (Multi-row Card) 或 KPI 指標",
                    "計算邏輯：需使用 DAX 計算「前月比 (MoM)」與「去年同期比 (YoY)」",
                    "條件格式化：正成長顯示綠色，負成長顯示紅色",
                    "互動性：數值需隨篩選器 (Slicer) 連動變化"
                ],
                color: "emerald"
            },
            {
                id: 3,
                title: "結構與組成分析",
                iconPath: "M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z",
                pageRef: "Page 3",
                description: "分析資料的組成結構，了解自動化與手動作業的比例分佈。",
                details: [
                    "視覺化類型：甜甜圈圖 (Donut Chart) 或 旭日圖 (Sunburst)",
                    "資料層級：外圈為「各單位執行概況」，內圈為「執行類別」",
                    "中心資訊：中央需顯示「執行成功總次數」卡片",
                    "排版要求：圖表標籤需清晰，避免重疊"
                ],
                color: "purple"
            },
            {
                id: 4,
                title: "量能統計分析",
                iconPath: "M4 6h16M4 12h16M4 18h7", // Simplified bar
                pageRef: "Page 4",
                description: "觀察每個月的執行量能是否穩定，並找出低於平均的月份。",
                details: [
                    "視覺化類型：群組直條圖 (Clustered Column Chart)",
                    "分析維度：各月份執行次數統計",
                    "分析線：必須加入一條「平均值 (Average Line)」作為基準參考",
                    "資料標籤：長條上方需顯示具體數值"
                ],
                color: "cyan"
            },
            {
                id: 5,
                title: "關聯與動態分析",
                iconPath: "M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z M21 12a9 9 0 11-18 0 9 9 0 0118 0z", // Play icon like
                pageRef: "Page 5",
                description: "進階動態圖表。展示不同單位在「成功率」與「失敗率」之間的消長關係。",
                details: [
                    "視覺化類型：散佈圖 (Scatter Chart)",
                    "軸向定義：X軸為成功率，Y軸為失敗率",
                    "維度：泡泡大小代表執行量，顏色代表不同單位",
                    "動態播放軸 (Play Axis)：必須設置「月份」為播放軸"
                ],
                color: "rose"
            }
        ];

        // Render Cards
        const grid = document.getElementById('module-grid');
        
        modules.forEach((mod, index) => {
            const card = document.createElement('div');
            
            let colorClass = 'text-blue-600 bg-blue-50';
            let ringClass = 'group-hover:ring-blue-200';
            if(mod.color === 'emerald') { colorClass = 'text-emerald-600 bg-emerald-50'; ringClass = 'group-hover:ring-emerald-200'; }
            if(mod.color === 'purple') { colorClass = 'text-purple-600 bg-purple-50'; ringClass = 'group-hover:ring-purple-200'; }
            if(mod.color === 'cyan') { colorClass = 'text-cyan-600 bg-cyan-50'; ringClass = 'group-hover:ring-cyan-200'; }
            if(mod.color === 'rose') { colorClass = 'text-rose-600 bg-rose-50'; ringClass = 'group-hover:ring-rose-200'; }

            card.className = `bg-white rounded-2xl p-8 shadow-sm border border-slate-100 card-hover cursor-pointer transition-all duration-300 relative overflow-hidden group hover:ring-2 ${ringClass}`;
            card.onclick = () => openModal(index);
            
            card.innerHTML = `
                <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                    <svg class="w-24 h-24 ${colorClass.split(' ')[0]}" fill="currentColor" viewBox="0 0 24 24"><path d="${mod.iconPath}"></path></svg>
                </div>
                <div class="w-14 h-14 rounded-xl ${colorClass} flex items-center justify-center mb-6 shadow-sm">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${mod.iconPath}"></path></svg>
                </div>
                <h3 class="text-xl font-bold text-slate-900 mb-2 group-hover:text-blue-600 transition-colors">${mod.title}</h3>
                <p class="text-slate-500 mb-4 line-clamp-2">${mod.description}</p>
                <div class="flex items-center text-sm font-semibold text-slate-400 group-hover:text-slate-700 mt-auto">
                    <span>查看詳細規格</span>
                    <svg class="w-4 h-4 ml-1 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </div>
            `;
            grid.appendChild(card);
        });

        // Modal Logic
        const modal = document.getElementById('detail-panel');
        const modalTitle = document.getElementById('modal-title');
        const modalDesc = document.getElementById('modal-desc');
        const modalDetails = document.getElementById('modal-details');
        const modalIcon = document.getElementById('modal-icon');
        const modalIconBg = document.getElementById('modal-icon-bg');
        const modalRef = document.getElementById('modal-ref');

        function openModal(index) {
            const mod = modules[index];
            modalTitle.innerText = mod.title;
            modalDesc.innerText = mod.description;
            modalRef.innerText = `參考來源: ${mod.pageRef}`;
            
            // Clear and populate list
            modalDetails.innerHTML = '';
            mod.details.forEach(item => {
                const li = document.createElement('li');
                li.className = "flex items-start text-slate-700";
                li.innerHTML = `
                    <svg class="w-5 h-5 text-green-500 mr-3 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                    <span>${item}</span>
                `;
                modalDetails.appendChild(li);
            });

            // Update Icon path
            modalIcon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${mod.iconPath}"></path>`;
            
            // Show Modal
            modal.classList.remove('hidden');
            modal.querySelector('div[class*="transform"]').classList.add('fade-in');
            document.body.style.overflow = 'hidden'; // Prevent scrolling
        }

        function closeModal() {
            modal.classList.add('hidden');
            document.body.style.overflow = ''; // Restore scrolling
        }

        // Close on escape
        document.onkeydown = function(evt) {
            evt = evt || window.event;
            if (evt.keyCode == 27) {
                closeModal();
            }
        };

        // Smooth Scroll
        function scrollToSection(id) {
            const element = document.getElementById(id);
            if(element) {
                const navbarHeight = document.getElementById('navbar').offsetHeight;
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - navbarHeight;
            
                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });
            }
        }
        
        // Add click events to links for smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                scrollToSection(this.getAttribute('href').substring(1));
            });
        });

        // Sticky Navbar effect
        window.addEventListener('scroll', () => {
            const nav = document.getElementById('navbar');
            if (window.scrollY > 20) {
                nav.classList.add('shadow-md');
                nav.classList.add('bg-white/95');
            } else {
                nav.classList.remove('shadow-md');
                nav.classList.remove('bg-white/95');
            }
        });
    </script>
</body>
</html>

